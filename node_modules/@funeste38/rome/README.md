# @funeste38/rome

**Tous les chemins mÃ¨nent Ã  Rome** â€” CLI pour monorepos + utilitaires TypeScript

Un outil CLI moderne pour gÃ©rer les monorepos avec exÃ©cution parallÃ¨le, auto-dÃ©tection des workspaces, et compatibilitÃ© cross-platform (Windows PowerShell inclus).

[![npm version](https://img.shields.io/npm/v/@funeste38/rome.svg)](https://www.npmjs.com/package/@funeste38/rome)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

---

## ğŸš€ FonctionnalitÃ©s

âœ… **Gestion des processus** : `--detach`, `processes`, logs sÃ©parÃ©s, redÃ©marrage auto  
âœ… **Configuration avancÃ©e** : `rome.json` avec section `processes` personnalisable  
âœ… **Cockpit intelligent** : Lancement automatique selon configuration  
âœ… **Robustesse maximale** : Processus isolÃ©s, gestion des signaux, monitoring continu

---

## ğŸ” Gestion des environnements (optionnel)

Rome peut s'intÃ©grer Ã  `envapt` pour charger des profils d'environnement et utiliser `@funeste38/envapt-nezlephant` pour gÃ©rer des secrets encodÃ©s en images PNG. Cette intÃ©gration est optionnelle : Rome reste pleinement fonctionnel sans ces paquets.

Installation (optionnelle) :

```bash
npm i envapt @funeste38/envapt-nezlephant --save-dev
```

Usage (exemples) :

- VÃ©rifier un profil :

```bash
rome env check --profile dev
```

- GÃ©nÃ©rer un `.env` pour un target (web/server) :

```bash
rome env generate web --profile production --out apps/web/.env.production
```

- Chiffrer/dÃ©chiffrer des secrets avec Nezlephant :

```bash
rome env encrypt apps/server/.env.production --out secrets/a11.png
rome env decrypt secrets/a11.png --out apps/server/.env.production
```

Notes :
- Les dÃ©pendances `envapt` et `@funeste38/envapt-nezlephant` sont chargÃ©es dynamiquement par Rome ; les projets qui n'utilisent pas `rome env` ne sont pas impactÃ©s.
- Documentez vos profils dans `envapt.config.(ts|json)` si vous souhaitez que `rome env init` gÃ©nÃ¨re une configuration par dÃ©faut.

---

## ğŸ“¦ Installation

```bash
npm i @funeste38/rome@latest
# ou
pnpm add @funeste38/rome@latest
yarn add @funeste38/rome@latest
```

---

## ğŸ–¥ï¸ CLI - Commandes principales

Rome fournit un CLI pour gÃ©rer vos workspaces en dÃ©veloppement.

### ExÃ©cution simple

```bash
# Auto-cd vers un workspace + exÃ©cuter une commande
rome run server -- npm run dev
rome run web -- npm run dev

# Lancement automatique selon le nombre de workspaces dÃ©tectÃ©s
rome start    # 1 workspace â†’ run, 2 â†’ duo, 3 â†’ trio
```

### ExÃ©cution parallÃ¨le

```bash
# 2 services en parallÃ¨le avec logs prÃ©fixÃ©s
rome duo server "npm run dev" web "npm run dev"

# 3 services en parallÃ¨le
rome trio server "npm run dev" web "npm run dev" ai "npm run start"
```

### Auto-dÃ©tection des workspaces

Le CLI dÃ©tecte automatiquement ces dossiers :

- **Racine** : `server`, `backend`, `api`, `web`, `front`, `client`, `app`
- **Sous-dossiers** : `apps/`, `packages/`, `services/`, `src/`
- **RÃ©cursif** : recherche dans tous les sous-dossiers courants

### Nettoyage des node_modules

```bash
# Nettoyer un workspace spÃ©cifique
rome clean front

# Nettoyer tous les workspaces
rome clean
```

### Installation automatique des dÃ©pendances

Si `npm run dev` Ã©choue, Rome tente automatiquement :

1. âœ… DÃ©tection de l'Ã©chec
2. ğŸ”„ Installation des dÃ©pendances avec `npm install`
3. ğŸ”„ RedÃ©marrage de la commande

### FixPath - Auto-cd intelligent

```bash
# Se positionne automatiquement dans le workspace
rome fix server -- npm run dev
rome fix web -- npm run build
```

### Gestion des workspaces

```bash
# Build tous les workspaces
rome build

# Build un workspace spÃ©cifique
rome build front

# Test tous les workspaces
rome test

# Lint tous les workspaces
rome lint
```

### Gestion des tunnels

```bash
# DÃ©marrer un tunnel ngrok
rome tunnel up 3000

# ArrÃªter le tunnel
rome tunnel down

# VÃ©rifier le statut du tunnel
rome tunnel status

# Tester la connectivitÃ© du tunnel
rome tunnel test

# Lancer un terminal split pour monitoring
rome tunnel split

# Lanceur automatique (serveur + tunnel + monitoring)
rome tunnel auto
```

### DÃ©ploiement Cloud

```bash
# DÃ©ploiement Netlify (avec build automatique)
rome deploy build

# DÃ©ploiement Netlify (build existant)
rome deploy

# Gestion des tunnels Cloudflare
rome cf up [port]        # Tunnel nommÃ© (stable)
rome cf up --detach      # Tunnel nommÃ© en arriÃ¨re-plan
rome cf quick [port]     # Tunnel rapide (Ã©phÃ©mÃ¨re)
rome cf quick --detach   # Tunnel rapide en arriÃ¨re-plan
rome cf down             # ArrÃªter tous les tunnels
```

### Cockpit de dÃ©veloppement

```bash
# Lancer tous les services en parallÃ¨le (multi-panels)
rome cockpit

# Lance automatiquement :
# - Serveur backend (apps/server)
# - Ollama (si disponible)
# - Tunnel Cloudflare
# - Frontend (apps/web)
```

### Gestion des processus dÃ©tachÃ©s

Rome supporte maintenant l'exÃ©cution de processus en arriÃ¨re-plan pour Ã©viter les interruptions.

#### Mode dÃ©tachÃ©

```bash
# Lancer des processus en arriÃ¨re-plan
rome duo server "npm run dev" web "npm run dev" --detach
rome trio server "npm run dev" web "npm run dev" ai "npm run start" --detach
rome start --detach

# Les processus continuent mÃªme si le terminal est fermÃ©
# Retour immÃ©diat au prompt avec confirmation
```

#### Gestion des processus actifs

```bash
# Lister tous les processus Rome actifs
rome processes
rome processes list

# ArrÃªter tous les processus Rome
rome processes stop
```

#### Configuration personnalisÃ©e des processus

Le fichier `rome.json` supporte maintenant une section `processes` pour dÃ©finir des services personnalisÃ©s :

```json
{
  "processes": {
    "server": {
      "command": "npm run dev",
      "cwd": "apps/server",
      "detach": true,
      "restart": "always",
      "env": { "NODE_ENV": "development" }
    },
    "web": {
      "command": "npm run dev",
      "cwd": "apps/web",
      "detach": true,
      "restart": "on-failure"
    },
    "tunnel": {
      "command": "cloudflared tunnel --url http://127.0.0.1:3000",
      "detach": true,
      "restart": "on-failure"
    },
    "ollama": {
      "command": "ollama serve",
      "detach": true,
      "restart": "on-failure"
    }
  }
}
```

**PropriÃ©tÃ©s des processus :**

- `command` : Commande Ã  exÃ©cuter (obligatoire)
- `cwd` : RÃ©pertoire de travail (optionnel)
- `detach` : Mode dÃ©tachÃ© (optionnel, dÃ©faut: true)
- `restart` : Politique de redÃ©marrage (`always`/`on-failure`/dÃ©sactivÃ©)
- `env` : Variables d'environnement (optionnel)

#### Logs sÃ©parÃ©s et monitoring

```bash
# Chaque processus Ã©crit dans son propre fichier log
# Logs disponibles dans le dossier ./logs/
# - server.log
# - web.log
# - tunnel.log
# - ollama.log

# RedÃ©marrage automatique selon la configuration
# Surveillance continue des processus
```

### Configuration personnalisÃ©e

```bash
# CrÃ©er un fichier de configuration
rome init

# Le fichier rome.json permet de personnaliser :
# - Patterns de dÃ©tection des workspaces
# - Gestionnaire de paquets (npm/yarn/pnpm/auto)
# - Scripts personnalisÃ©s
```

### Sauvegarde et restauration

```bash
# Sauvegarder la configuration actuelle
rome backup

# Restaurer la derniÃ¨re sauvegarde
rome restore

# Restaurer une sauvegarde spÃ©cifique
rome restore rome.json.backup.2025-11-07T20-52-33
```

**SystÃ¨me de sauvegarde automatique :**

- `rome init` sauvegarde automatiquement avant de rÃ©gÃ©nÃ©rer
- `rome restore` sauvegarde la config actuelle avant de restaurer
- Fichiers nommÃ©s avec timestamp pour traÃ§abilitÃ©

### ğŸ›ï¸ SystÃ¨me Militaire - Indexation Romaine

Rome transforme vos repositories en **armÃ©e romaine** avec une classification automatique des fichiers et dossiers.

#### HiÃ©rarchie Militaire

Chaque Ã©lÃ©ment de votre projet reÃ§oit un rÃ´le militaire :

- **ğŸ‘¨â€âœˆï¸ Capitaine** = Dossier (workspace, src/, components/, etc.)
- **ğŸ¹ Archer** = Documentation (.md, .txt, README, etc.)
- **ğŸ—ï¸ Catapulte** = Scripts/Build (package.json, Dockerfile, scripts)
- **âš”ï¸ Infanterie** = Code source (.ts, .js, .py, .java, etc.)
- **ğŸ Cavalerie** = Tests (test/, spec/, \*.test.js, etc.)
- **ğŸ‘‘ Centurion** = Configuration (tsconfig.json, eslint.config.js, etc.)
- **ğŸ¦… Aquila** = Ã‰tendards (package.json principal, rome.json)
- **ğŸ”« Balliste** = Assets/DonnÃ©es (.json, .yaml, .csv, images)

#### Formations Automatiques

Rome classe automatiquement vos repositories selon leur taille et complexitÃ© :

- **ğŸ° Bataillon** : Petit projet (< 10 unitÃ©s, â‰¤ 2 catapultes, â‰¤ 5 infanterie)
- **âš”ï¸ LÃ©gion** : Projet moyen (< 50 unitÃ©s, â‰¤ 5 capitaines)
- **ğŸ›ï¸ ArmÃ©e** : Grand projet (â‰¥ 50 unitÃ©s, nombreux capitaines)

#### Inspection des Troupes

```bash
# Voir l'armÃ©e complÃ¨te avec toutes les formations
rome army

# Exemple de sortie :
ğŸ›ï¸  ARMÃ‰E ROMAINE - Formations DÃ©tectÃ©es
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš”ï¸ LÃ©gion "mon-projet" (Force: 45)
   ğŸ“ /path/to/mon-projet
   ğŸ¦… 1 Aigles
   ğŸ‘‘ 3 Centurions
   ğŸ—ï¸ 5 Catapultes
   âš”ï¸ 25 Infanterie
   ğŸ 8 Cavalerie
   ğŸ‘¨â€âœˆï¸ 3 Capitaines
```

---

## ğŸ—ï¸ Setup Repository - Scripts PowerShell

Rome inclut des scripts PowerShell pour initialiser rapidement vos repositories.

### Monorepo (recommandÃ©)

```powershell
# Depuis votre dossier projet
.\scripts\repo-reshape.ps1 -Mode mono

# CrÃ©e la structure :
# â”œâ”€â”€ apps/
# â”‚   â”œâ”€â”€ web/     (Vite + React)
# â”‚   â””â”€â”€ server/  (Express)
# â”œâ”€â”€ package.json (workspaces)
# â”œâ”€â”€ tsconfig.base.json
# â””â”€â”€ netlify.toml
```

### Split repos (2 dÃ©pÃ´ts sÃ©parÃ©s)

```powershell
.\scripts\repo-reshape.ps1 -Mode split

# CrÃ©e la structure :
# â”œâ”€â”€ repos/
# â”‚   â”œâ”€â”€ web/     (Vite + React + netlify.toml)
# â”‚   â””â”€â”€ server/  (Express)
```

### Configuration

```powershell
# ParamÃ¨tres optionnels
.\scripts\repo-reshape.ps1 -Mode mono -Root "C:\MonProjet"
```

---

## ğŸŒ DÃ©ploiement et IntÃ©gration Cloud

Rome supporte le dÃ©ploiement moderne avec mock API et tunnels sÃ©curisÃ©s.

### ğŸ”Œ API Mock + Fallback Upstream (Netlify Function)

CrÃ©ez `netlify/functions/a11-chat.js` pour une API ChatGPT-compatible avec fallback :

```javascript
// Netlify Function: mock + fallback upstream (Cloudflare tunnel / API publique)
const UPSTREAM = process.env.UPSTREAM_URL || ""; // ex: https://api.funesterie.pro
const DEFAULT_MODEL = process.env.DEFAULT_MODEL || "llama3.1:8b-instruct";

exports.handler = async (event) => {
  const headers = {
    "Access-Control-Allow-Origin": "*",
    "Content-Type": "application/json",
  };
  const body = event.body ? JSON.parse(event.body) : {};
  const model = body.model || DEFAULT_MODEL;

  // 1) Forward vers upstream si disponible
  if (UPSTREAM) {
    try {
      const r = await fetch(`${UPSTREAM}/v1/chat/completions`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ ...body, model }),
        signal: AbortSignal.timeout(8000),
      });
      const text = await r.text();
      return { statusCode: r.status, headers, body: text };
    } catch (_) {
      /* fallback mock */
    }
  }

  // 2) Mock (toujours dispo)
  const msg = body?.messages?.[0]?.content || "";
  return {
    statusCode: 200,
    headers,
    body: JSON.stringify({
      id: "chatcmpl-mock",
      object: "chat.completion",
      created: Math.floor(Date.now() / 1000),
      model,
      choices: [
        {
          index: 0,
          message: {
            role: "assistant",
            content: `(MODE DEV) Mock. Tu as dit: "${msg}"`,
          },
          finish_reason: "stop",
        },
      ],
    }),
  };
};
```

**Configuration Netlify :**

```toml
[build]
  command   = "npm --prefix apps/web run build"
  publish   = "apps/web/dist"
  functions = "netlify/functions"

[[redirects]]
  from   = "/api/*"
  to     = "/.netlify/functions/a11-chat/:splat"
  status = 200
  force  = true
```

**Variables d'environnement Netlify :**

```
DEFAULT_MODEL=llama3.1:8b-instruct
UPSTREAM_URL=https://api.funesterie.pro  # ou https://xxxxx.trycloudflare.com
```

### ğŸŒ©ï¸ Cloudflare Tunnel â€” 2 modes

#### A) Tunnel nommÃ© (URL stable, recommandÃ©)

```bash
winget install Cloudflare.cloudflared
cloudflared tunnel login
cloudflared tunnel create a11-local
```

**Config locale** (`~/.cloudflared/config.yml`) :

```yaml
tunnel: a11-local
credentials-file: ~/.cloudflared/a11-local.json
ingress:
  - hostname: api.funesterie.pro
    service: http://127.0.0.1:3000
  - service: http_status:404
```

```bash
# DNS (si zone chez Cloudflare)
cloudflared tunnel route dns a11-local api.funesterie.pro
# Run
cloudflared tunnel run a11-local
```

#### B) Quick tunnel (URL Ã©phÃ©mÃ¨re)

```bash
cloudflared tunnel --url http://127.0.0.1:3000
# Copiez l'URL gÃ©nÃ©rÃ©e pour UPSTREAM_URL
```

### ğŸ§ª Profils d'environnement (front)

**DÃ©veloppement** (`apps/web/.env.local`) :

```bash
VITE_API_BASE=http://127.0.0.1:3000
VITE_MODEL=llama3.1:8b-instruct
```

**Production** (`apps/web/.env.production`) :

````bash
---

## ğŸ› ï¸ Scripts NPM Ã©tendus

Ajoutez ces scripts dans votre `package.json` racine pour une expÃ©rience de dÃ©veloppement complÃ¨te :

```json
{
  "scripts": {
    "web:build": "npm --prefix apps/web run build",
    "web:dev": "npm --prefix apps/web run dev",
    "deploy": "npx netlify deploy --prod --dir=apps/web/dist --functions=netlify/functions",
    "deploy:build": "npm run web:build && npm run deploy",
    "start:a11": "node apps/server/server.cjs",
    "tunnel": "cloudflared tunnel --url http://127.0.0.1:3000",
    "rome:start": "rome start"
  }
}
````

### âš¡ "Cockpit Rome" (multi-panels)

Script PowerShell pour lancer tous les services en parallÃ¨le :

```powershell
# scripts/rome-cockpit.ps1
Start-Process powershell -ArgumentList 'cd apps/server; npm run dev'
Start-Process powershell -ArgumentList 'ollama serve'
Start-Process powershell -ArgumentList 'cloudflared tunnel --url http://127.0.0.1:3000'
Start-Process powershell -ArgumentList 'npm --prefix apps/web run dev'
```

### âœ… Check-list "Ã§a marche en prod"

```bash
# 1. Lier le site Netlify
npx netlify link --name votre-site

# 2. Build et dÃ©ploiement
npm run web:build
npm run deploy

# 3. Tests
curl https://votre-site.netlify.app/.netlify/functions/a11-chat
# â†’ JSON OK

# POST vers https://votre-site.netlify.app/api/v1/chat/completions
# â†’ Tunnel UP: vraie rÃ©ponse IA
# â†’ Tunnel OFF: mock propre (pas d'erreur)
```

---

## ï¿½ API TypeScript

### fixPath - RÃ©solution de chemins ESM

```typescript
import { fixPath } from "@funeste38/rome/fixPath";

// Auto-dÃ©tection du workspace + commande optionnelle
await fixPath("server", "npm run dev");
await fixPath(); // auto-cd seulement
```

### Commandes programmatiques

```typescript
import { run, duo, trio } from "@funeste38/rome";

// ExÃ©cution simple
await run("server", ["npm", "run", "dev"]);

// ExÃ©cution parallÃ¨le
await duo("server", ["npm", "run", "dev"], "web", ["npm", "run", "dev"]);

await trio(
  "server",
  ["npm", "run", "dev"],
  "web",
  ["npm", "run", "dev"],
  "ai",
  ["npm", "run", "start"]
);
```

---

## âš™ï¸ DÃ©veloppement & Build

### Build du package

```bash
npm run build  # TypeScript â†’ dist/
```

### Structure de build

```
dist/
â”œâ”€â”€ index.js + .d.ts     # Exports principaux
â”œâ”€â”€ cli.js + .d.ts       # Point d'entrÃ©e CLI
â”œâ”€â”€ fixPath.js + .d.ts   # Utilitaire chemins
â”œâ”€â”€ run.js + .d.ts       # ExÃ©cution simple
â”œâ”€â”€ duo.js + .d.ts       # ExÃ©cution duo
â”œâ”€â”€ trio.js + .d.ts      # ExÃ©cution trio
â”œâ”€â”€ tunnel.js + .d.ts    # Gestion des tunnels
â””â”€â”€ utils.js + .d.ts     # Utilitaires internes
```

### Release & Publication

```bash
# Version automatique + publication
npm run release

# Ou manuellement :
npm version patch  # ou minor/major
npm publish --access public
```

---

## ğŸ§¾ Changelog

### v1.5.3

- âœ… **Correction critique mode dÃ©tachÃ©** : Suppression des `await` bloquants dans `launchDetachedProcess`
- âœ… **DÃ©tachement complet** : Ajout de `child.unref()` pour dÃ©tacher complÃ¨tement du processus parent
- âœ… **Retour immÃ©diat** : Les commandes `--detach` reviennent maintenant instantanÃ©ment au prompt
- âœ… **Processus vraiment indÃ©pendants** : Les processus dÃ©tachÃ©s survivent Ã  la fermeture du terminal parent
- âœ… **Cross-platform robuste** : Comportement identique sur Windows, Linux et macOS

### v1.5.2

- âœ… **Correction mode dÃ©tachÃ© duo/trio** : `rome duo --detach` et `rome trio --detach` lancent maintenant vraiment les processus en arriÃ¨re-plan
- âœ… **Processus rÃ©ellement dÃ©tachÃ©s** : Utilisation de `detached: true` et redirection des logs sÃ©parÃ©s
- âœ… **Logs individuels** : Chaque processus dÃ©tachÃ© Ã©crit dans `./logs/{workspace}-{label}.log`
- âœ… **Terminal libÃ©rÃ©** : Plus besoin de Ctrl+C, retour immÃ©diat au prompt
- âœ… **CohÃ©rence cross-commandes** : MÃªme comportement dÃ©tachÃ© pour toutes les commandes multi-workspaces

### v1.5.1

- âœ… **Cloudflare tunnels dÃ©tachÃ©s** : Support `--detach` pour `rome cf up` et `rome cf quick`
- âœ… **Correction parsing arguments** : Utilisation de `filteredArgs` pour Ã©viter les conflits avec `--detach`
- âœ… **Logs sÃ©parÃ©s pour tunnels** : `cloudflare-tunnel.log` et `cloudflare-quick.log`
- âœ… **AmÃ©lioration documentation** : README mis Ã  jour avec les options `--detach` pour Cloudflare

### v1.5.0

- âœ… **Gestion des processus dÃ©tachÃ©s** : Option `--detach` pour exÃ©cution en arriÃ¨re-plan
- âœ… **Commande `processes`** : `rome processes list` et `rome processes stop`
- âœ… **Configuration `rome.json`** : Section `processes` pour dÃ©finir des services personnalisÃ©s
- âœ… **Logs sÃ©parÃ©s** : Chaque processus Ã©crit dans `./logs/{nom}.log`
- âœ… **RedÃ©marrage automatique** : Politiques `always`/`on-failure` configurables
- âœ… **Cockpit amÃ©liorÃ©** : Utilise la configuration `rome.json` pour les processus
- âœ… **Robustesse accrue** : Gestion des signaux et isolation des processus
- âœ… **Cross-platform** : Support Windows PowerShell et Unix pour la gestion des processus

### v1.4.0

- âœ… **Version mineure** : Nouvelles fonctionnalitÃ©s de dÃ©ploiement cloud
- âœ… **Commandes CLI cloud** : `rome deploy`, `rome cockpit`, `rome cf` (Cloudflare)
- âœ… **DÃ©ploiement Netlify intÃ©grÃ©** : Build + dÃ©ploiement en une commande
- âœ… **Cockpit multi-panels** : Lancement automatique de tous les services de dev
- âœ… **Gestion Cloudflare** : Tunnels nommÃ©s stables et tunnels rapides Ã©phÃ©mÃ¨res
- âœ… **Fichiers de dÃ©ploiement** : Netlify Functions, configs, environnements prÃªts

### v1.3.9

- âœ… **Publication patch** : Corrections de templates et scripts gÃ©nÃ©rÃ©s
- âœ… **Templates server.js** : Utilisation propre de `const PORT = process.env.PORT || 3000` pour Ã©viter les duplications
- âœ… **Scripts gÃ©nÃ©rÃ©s** : Tous les projets crÃ©Ã©s par `repo-reshape.ps1` incluent maintenant `test` et `lint` scripts
- âœ… **Robustesse CLI** : `npx rome build/test/lint` fonctionne sur tous les workspaces gÃ©nÃ©rÃ©s
- âœ… **DÃ©ploiement cloud** : IntÃ©gration Netlify Functions + Cloudflare Tunnel
- âœ… **API Mock + Fallback** : Function Netlify avec mock local et upstream forwarding
- âœ… **Scripts Ã©tendus** : Commandes deploy, tunnel, cockpit ajoutÃ©es
- âœ… **Profils environnement** : .env.local/.env.production pour le frontend
- âœ… **Cockpit multi-panels** : Script PowerShell pour dÃ©veloppement intÃ©grÃ©
- âœ… **Commandes CLI cloud** : `rome deploy`, `rome cockpit`, `rome cf` (Cloudflare)

### v1.3.8

- âœ… **Publication stable** : Version 1.3.8 avec toutes les corrections et amÃ©liorations
- âœ… **Workspaces complets** : Tous les workspaces de test ont maintenant les scripts requis
- âœ… **FonctionnalitÃ©s tunnel** : SystÃ¨me de tunnels ngrok entiÃ¨rement opÃ©rationnel
- âœ… **Documentation Ã  jour** : README complet avec toutes les nouvelles fonctionnalitÃ©s
- âœ… **Templates corrigÃ©s** : Server.js templates utilisent maintenant `const PORT = process.env.PORT || 3000` pour Ã©viter les duplications
- âœ… **Scripts gÃ©nÃ©rÃ©s** : Les projets gÃ©nÃ©rÃ©s par `repo-reshape.ps1` incluent maintenant `test` et `lint` scripts dans tous les package.json

### v1.3.7

- âœ… **ğŸŒ SystÃ¨me de tunnels intÃ©grÃ©** : Gestion complÃ¨te des tunnels ngrok
- âœ… **Commandes tunnel** : `rome tunnel up/down/status/test/split/auto`
- âœ… **Tests de connectivitÃ©** : VÃ©rification automatique des endpoints (/health, /status, /api/\*)
- âœ… **Terminaux split** : Monitoring multi-onglets avec PowerShell
- âœ… **Lanceur automatique** : DÃ©marrage serveur + tunnel + monitoring intÃ©grÃ©
- âœ… **Timeout gÃ©rÃ©** : AbortController pour les requÃªtes HTTP fiables
- âœ… **Corrections ESM** : Imports ES6 complets, plus de require()
- âœ… **Fix workspaces** : Scripts build/test/lint ajoutÃ©s aux workspaces de test

### v1.3.5

- âœ… **Corrections ESM** : Fix "require is not defined" dans cleanNodeModules
- âœ… **DÃ©duplication renforcÃ©e** : Ã‰limination complÃ¨te des doublons (backend vs apps/backend)
- âœ… **PrÃ©-install sÃ©quentielle** : Nouvelle fonction preInstallAllDeps() pour stabilitÃ©
- âœ… **Import spawnSync** : Utilisation des imports ESM au lieu de require()

### v1.3.4

- âœ… **DÃ©duplication des workspaces** : Utilisation de `realpath` pour Ã©viter les doublons
- âœ… **Normalisation des chemins** : Affichage relatif (`.`) au lieu des chemins absolus
- âœ… **AmÃ©lioration robustesse** : Gestion des liens symboliques et chemins normalisÃ©s
- âœ… **Affichage optimisÃ©** : Chemins plus lisibles dans `rome army`

### v1.3.3

- âœ… **ğŸ›ï¸ SystÃ¨me Militaire** : Indexation automatique avec mÃ©taphore romaine
- âœ… **Classification automatique** : Capitaine/Archer/Catapulte/Infanterie/Cavalerie/Centurion/Aquila/Balliste
- âœ… **Formations intelligentes** : Bataillon/LÃ©gion/ArmÃ©e selon la taille du projet
- âœ… **Commande `rome army`** : Inspection visuelle des troupes avec comptage des unitÃ©s
- âœ… **Analyse rÃ©cursive** : Scan automatique de la structure des fichiers
- âœ… **MÃ©taphore hyper-pratique** : Navigation intuitive des repositories

### v1.3.1

- âœ… **SystÃ¨me de sauvegarde** : `rome backup` et `rome restore`
- âœ… **Sauvegarde automatique** lors de `rome init` et `rome restore`
- âœ… **Gestion des versions de config** avec timestamps
- âœ… **SÃ©curitÃ© renforcÃ©e** pour les modifications de configuration

### v1.3.0

- âœ… **Nouvelles commandes** : `rome build`, `rome test`, `rome lint` pour tous les workspaces
- âœ… **Configuration personnalisable** : `rome init` crÃ©e un fichier `rome.json`
- âœ… **Multi-gestionnaires** : dÃ©tection automatique npm/yarn/pnpm
- âœ… **Configuration avancÃ©e** : patterns personnalisÃ©s, scripts custom, exclusions

### v1.2.11

- âœ… AmÃ©lioration dÃ©tection workspaces (services/, src/, rÃ©cursif)
- âœ… Commande `rome clean` pour node_modules verrouillÃ©s
- âœ… Installation automatique des dÃ©pendances en cas d'Ã©chec
- âœ… Meilleur logging et feedback utilisateur
- âœ… CompatibilitÃ© Windows amÃ©liorÃ©e

### v1.2.9

- âœ… Fix PowerShell syntax errors dans repo-reshape.ps1
- âœ… AmÃ©lioration compatibilitÃ© Windows

### v1.2.6 - v1.2.8

- âœ… Ajout commandes `run`/`start`/`trio` pour gestion monorepos
- âœ… Auto-dÃ©tection workspaces depuis package.json
- âœ… CompatibilitÃ© Windows PowerShell avec NODE_OPTIONS
- âœ… CLI zero dÃ©pendances, pur Node.js

### v1.2.4

- âœ… Mode `duo` pour dÃ©veloppement front/back parallÃ¨le
- âœ… CLI cross-platform avec auto-cd et exÃ©cution commandes
- âœ… Zero dÃ©pendances runtime

### v1.1.0 - v1.2.3

- âœ… SÃ©paration builds client/server
- âœ… Version client browser-safe
- âœ… Helper `url()` pour gÃ©nÃ©ration routes
- âœ… Typings TypeScript complets
- âœ… Fallback "browser" field

---

## ğŸ¤ Contribution

Issues et PRs bienvenues sur [GitHub](https://github.com/jEFFLEZ/rome) !

### DÃ©veloppement local

```bash
git clone https://github.com/jEFFLEZ/rome.git
cd rome
npm install
npm run build
npm link  # pour tester localement
```

---

## ğŸ“„ License

MIT Â© 2025 â€” [jEFFLEZ](https://github.com/jEFFLEZ)

---

_Tous les chemins mÃ¨nent Ã  Rome â€” CLI moderne pour vos monorepos_
