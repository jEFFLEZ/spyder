import { loadProfile } from './index.js';
export async function envCommand(argv) {
    const cmd = argv._[1];
    if (cmd === 'check') {
        const target = argv._[2] || 'global';
        const profile = argv.profile || 'dev';
        const vars = await loadProfile(profile);
        console.log(`profile=${profile} target=${target} vars=${Object.keys(vars).length}`);
        return;
    }
    if (cmd === 'generate') {
        const target = argv._[2];
        const profile = argv.profile || 'dev';
        const out = argv.out;
        const vars = await loadProfile(profile);
        const content = Object.entries(vars).map(([k, v]) => `${k}=${String(v)}`).join('\n');
        if (out) {
            // write file
            const fs = await import('fs');
            await fs.promises.writeFile(out, content);
            console.log(`Wrote ${out}`);
        }
        else {
            console.log(content);
        }
        return;
    }
    console.log('Unknown env subcommand.');
}
