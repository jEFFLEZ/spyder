// Optional envapt integration entrypoint
export async function createEnvClient() {
    try {
        // Use require to avoid TypeScript complaining when module is absent
        // eslint-disable-next-line @typescript-eslint/no-var-requires
        const envaptMod = require('envapt');
        const Envapter = envaptMod?.Envapter || envaptMod?.default || envaptMod;
        let createNezConverter = undefined;
        try {
            // eslint-disable-next-line @typescript-eslint/no-var-requires
            const nez = require('@funeste38/envapt-nezlephant');
            createNezConverter = nez?.createNezConverter || nez?.default?.createNezConverter || nez?.default;
        }
        catch (e) {
            // optional
        }
        const env = new Envapter({
            converters: createNezConverter ? [createNezConverter()] : []
        });
        return env;
    }
    catch (err) {
        throw new Error('Missing optional dependency "envapt". Install it to use rome env commands.');
    }
}
export async function loadProfile(profile) {
    const env = await createEnvClient();
    return env.getManyWith(profile);
}
