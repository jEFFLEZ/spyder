trigger:
  - none

pr:
  - none

name: $(Build.BuildId)

stages:
  - stage: BuildAndPublish
    displayName: Build and publish QFlush extension
    jobs:
      - job: build
        displayName: Build
        pool:
          vmImage: 'ubuntu-latest'
        steps:
          - checkout: self
          - task: NodeTool@0
            inputs:
              versionSpec: '20.x'

          - script: |
              npm install --no-audit --no-fund
              npm run build
            displayName: 'Install and build'

      - job: publish
        displayName: Publish
        dependsOn: build
        pool:
          vmImage: 'ubuntu-latest'
        steps:
          - checkout: self
          - task: NodeTool@0
            inputs:
              versionSpec: '20.x'
          - script: |
              npm install --no-audit --no-fund
              npm run build
              # publish steps here - requires service connection / credentials
            displayName: 'Publish (manual configuration required)'
